# Проектные работы 12, 13 и 14, 15.
домен: shkirya.site
публичный IP: 84.201.142.52
## О Проекте
- [Яндекс Практикум](praktikum.yandex.ru) — курс веб-разработки.
- Отработка навыков работы с Node.js, Express, Mongodb, mongoose
- Настройка Роутинга, подключение файлов c данными, настройка eslinttc, настройка editconfig, подключение статики.
- [GH-Pages](https://zuhijan.github.io/project12/)
- создание REST API
- Реализуем аутентификацию и авторизацию
- Реализуем централизованную обработку ошибок, валидация запросов. env. загружаем на облачное хранилище
---
### checklist_12:
- в проекте есть package.json;
- в проекте есть .editorconfig;
- в проекте есть .eslintrc, расширяющий конфигурацию airbnb-base, а также необходимые для работы линтера dev-зависимости;
- в проекте есть .gitignore;
- команда npm run start запускает сервер на localhost:3000;
- команда npm run dev запускает сервер на localhost:3000 с хот релоудом;
- адрес localhost:3000 загружает фронтенд проекта Mesto, который вы делали;
- в ответ на запрос GET localhost:3000/users сервер вернёт JSON-объект из файла users.json;
- в ответ на запрос GET localhost:3000/cards сервер вернёт JSON-объект из файла cards.json;
- в ответ на запрос GET localhost:3000/users/8340d0ec33270a25f2413b69, сервер вернёт JSON-объект пользователя с переданным после /users идентификатором;
- если пользователя с запрошенным идентификатором нет, API должен возвращать 404 статус ответа и JSON: { "message": "Нет пользователя с таким id" };
- при запросе на несуществующий адрес, API должен возвращать 404 статус ответа и JSON: { "message": "Запрашиваемый ресурс не найден" }
---
### checklist_13:
- в .eslintrc добавлено исключение для _id;
- Node.js приложение подключается к серверу Mongo по адресу mongodb://localhost:27017/mestodb;
- создана схема и модель пользователя с полями name, about и avatar, поля корректно валидируются;
- создана схема и модель карточки с полями name, link, owner, likes и createdAt, поля корректно валидируются;
- запрос на GET /users возвращает всех пользователей из базы;
- запрос GET /users/:userId возвращает конкретного пользователя;
- запрос POST /users создаёт пользователя;
- запрос GET /cards возвращает все карточки всех пользователей;
- запрос POST /cards создаёт карточку;
- если в любом из перечисленных запросов что-то идёт не так, сервер возвращает ошибку со статусом;
- папки public и data удалены;
- запрос PATCH /users/me обновляет профиль;
- запрос PATCH /users/me/avatar обновляет аватар;
- запрос PUT /cards/:cardId/likes ставит лайк на карточку;
- запрос DELETE /cards/:cardId/likes убирает лайк с карточки;

### checklist_14:

- в схеме пользователя есть обязательные email и password;
- поле email уникально и валидируется;
- в контроллере createUser почта и хеш пароля записываются в базу;
- есть контроллер login, он проверяет, полученные в теле запроса почту и пароль;
- если почта и пароль верные, контроллер login создаёт JWT, в пейлоуд которого записано свойство _id с идентификатором пользователя; срок жизни токена — 7 дней;
- если почта и пароль верные, контроллер login возвращает созданный токен в ответе;
- если почта и пароль не верные, контроллер login возвращает ошибку 401;
- в app.js есть обработчики POST-запросов на роуты /signin и /signup;
- есть файл middlewares/auth.js, в нём мидлвэр для проверки JWT;
- при правильном JWT авторизационный мидлвэр добавляет в объект запроса пейлоуд и пропускает запрос дальше;
- при неправильном JWT авторизационный мидвэр возвращает ошибку 401;
- все роуты, кроме /signin и /signup, защищены авторизацией;
- удалён хардкод req.user из самостоятельного проекта предыдущего спринта;
- пользователь не может удалить карточку, которую он не создавал;
- API не возвращает хеш пароля;
- пользователь не может редактировать чужой профиль и не может менять чужой аватар.

### checklist_15:
- все ошибки обрабатываются централизованно;
- тела запросов и, где необходимо, заголовки и параметры, валидируются по определённым схемам. Если запрос не соответствует схеме, обработка не передаётся контроллеру и клиент получает ошибку валидации;
- все запросы и ответы записываются в файл request.log;
- все ошибки записываются в файл error.log;
- файлы логов не добавляются в репозиторий;
- к серверу можно обратиться по публичному IP-адресу, указанному в README.md;
- к серверу можно обратиться по http и по https, используя домен, указанный в README.md;
секретный ключ для создания и верификации JWT хранится на сервере в .env файле. Этот файл не добавляется в git;
- в режиме разработки (когда process.env.NODE_ENV !== 'production') код запускается и работает без наличия .env файла;
- сервер самостоятельно восстанавливается после GET-запроса на URL /crash-test.
